1     ' *****************************
2     ' *                           *
3     ' *         3d_graph          *
4     ' *                           *
5     ' *   Graphen in 2D und 3D    *
6     ' *     + PUBLIC DOMAIN +     *
7     ' *            by             *
8     ' *                           *
9     ' *       Stephan Meyer       *
10    '*                           *
11    '*****************************
13    DEF FNZ(X)=X^2+COS(X^2)/TAN(7)
14    F$=  "F(X)=X^2+COS(X^2)/TAN(7)"
15    GOSUB INIT
20    FULLW 2:CLEARW 2
25    GOSUB CLEARDESK
30    GOSUB FULLWIND:CLEARW 2
40    XL=-10:XM=10
50    XA=20:XB=620
60    YA=340:YB=20
90    GOTOXY 1,18:?F$
100   IF XL>0 THEN XL=0
110   IF XM<0 THEN XM=0
120   IF YL>0 THEN YL=0
130   IF YM<0 THEN YM=0
200   R=XM-XL
210   EX=-2
220   IF R<10^EX GOTO 240
230   EX=EX+1:GOTO 220
240   IX=1^(EX-1)
250   IF XM/IX <>INT(XM/IX) THEN XM=(INT(XM/IX)+1)*IX
260   IF XL/IX <>INT(XL/IX) THEN XL=INT(XL/IX)*IX
300   P=XB-XA
310   YL=0:YM=0
320   FOR X=XL TO XM STEP (XM-XL)/P
330   Y=FNZ(X)
340   IF Y<YL THEN YL=Y
350   IF Y>YM THEN YM=Y
360   NEXT
400   R=YM-YL
410   EY=-2
420   IF R<10^EY GOTO 440
430   EY=EY+1:GOTO 420
440   IY=1^(EY-1)
450   IF YM/IY <>INT(YM/IY) THEN YM=(INT(YM/IY)+1)*IY
460   IF YL/IY <>INT(YL/IY) THEN YL=INT(YL/IY)*IY
500   X0=INT(XA-XL*(XB-XA)/(XM-XL))
510   Y0=INT(YA+YL*(YB-YA)/(YL-YM))
600   LINEF XA,Y0,XB,Y0
610   LINEF X0,YA,X0,YB
650   I=IX
660   IF EX>3 THEN I=XM-XL
690   GROESSE=8:GOSUB SCHRIFTGROESSE
700   FOR J=0 TO(XM-XL)
710   K=INT(XA+J*(XB-XA)/(XM-XL))
730   LINEF K,Y0,K,Y0+4
740   XPOS=K-08:YPOS=Y0-06
742   IF J+XL=0 GOTO 750
745   TEXT$=STR$(J+XL):GOSUB TX
750   NEXT
800   FOR J=(YM-YL) TO 0 STEP -IY*ABS(INT((YM-YL)/25))
810   K=INT(YB-J*(YB-YA)/(YM-YL))
830   LINEF X0,K,X0+4,K
840   XPOS=X0+6 :YPOS=K-15
842   IF YM-J=0 GOTO 850
845   TEXT$=STR$(YM-J):GOSUB TX
850   NEXT
1000  FOR I=0 TO P
1010  X=XL+I*(XM-XL)/P
1020  Y=FNZ(X)
1030  YD=INT(YB-(Y-YM)*(YB-YA)/(YL-YM))
1040  LINEF XA+I,YD,XA+I,YD
1050  NEXT
1090  GROESSE=10:GOSUB SCHRIFTGROESSE
1095  A=INP(2)
5000  AK=.5:PK=.1
5010  W=640:H=400
5030  GOSUB CLEARDESK
5040  CLEARW 2
5050  PI=3.1416:T1=PI/8:T2=PI/4
5060  D1=500:D2=40
5070  S1=SIN(T1):C1=COS(T1)
5080  S2=SIN(T2):C2=COS(T2)
5110  DIM M(W)
5120  FOR I=0 TO W
5130  M(I)=H
5140  NEXT
5150  FOR X=7 TO -7 STEP -AK
5160  F=0
5170  FOR Y=-7 TO 7 STEP PK
5180  Z=FNZ(X)
5190  X1=X*C1+Y*S1
5200  Y1=-X*S1*C2+Y*C1*C2+Z*S2
5210  Z1= X*S1*S1-Y*C1*S2+Z*C2
5220  XP=(X1*D1/(Z1+D2))*2:YP=Y1*D1/(Z1+D2)
5230  XD=INT(XP+(W/2)):YD=INT(H*3/4-YP)
5240  IF XD<0 OR XD>W THEN F=0:GOTO ACHT
5250  IF YD<0 THEN M(XD)=0:F=0:GOTO ACHT
5260  IF YD>M(XD) THEN F=0:GOTO ACHT
5270  IF F=1 THEN LINEF XX,YY,XD,YD:GOTO ACHT
5280  LINEF XD,YD,XD,YD
5290  ACHT: NEXT Y,X
5300  GOTOXY 1,1:?F$
5310  A=INP(2)
6000  AK=.5:PK=.1
6010  W=640:H=400
6050  PI=3.1416:T1=PI/8:T2=PI/4
6060  D1=500:D2=40
6070  S1=SIN(T1):C1=COS(T1)
6080  S2=SIN(T2):C2=COS(T2)
6120  FOR I=0 TO W
6130  M(I)=H
6140  NEXT
6150  FOR y=7 TO -7 STEP -AK
6160  F=0
6170  FOR x=-7 TO 7 STEP PK
6180  Z=FNZ(X)
6190  X1=X*C1+Y*S1
6200  Y1=-X*S1*C2+Y*C1*C2+Z*S2
6210  Z1= X*S1*S1-Y*C1*S2+Z*C2
6220  XP=(X1*D1/(Z1+D2))*2:YP=Y1*D1/(Z1+D2)
6230  XD=INT(XP+(W/2)):YD=INT(H*3/4-YP)
6240  IF XD<0 OR XD>W THEN F=0:GOTO ABER
6250  IF YD<0 THEN M(XD)=0:F=0:GOTO ABER
6260  IF YD>M(XD) THEN F=0:GOTO ABER
6270  IF F=1 THEN LINEF XX,YY,XD,YD:GOTO ABER
6280  LINEF XD,YD,XD,YD
6290  ABER: NEXT x,y
6300  GOTOXY 1,1:?F$
6310  A=INP(2)
6320  END
62000 SETWIND:
62002 ' --> XPOS; YPOS; BREIT
62004 ' --> HOCH; FENSTERNR
62005 GOSUB INIT
62006 POKE GINTIN,FENSTERNR
62008 POKE GINTIN+2,5
62010 POKE GINTIN+4,XPOS
62012 POKE GINTIN+6,YPOS
62014 POKE GINTIN+8,BREIT
62016 POKE GINTIN+10,HOCH
62018 GEMSYS 105
62020 RETURN
62022 '--------------------------
62050 FULLWIND:
62052 ' 
62053 GOSUB INIT
62054 POKE GINTIN,3
62056 POKE GINTIN+2,5
62058 POKE GINTIN+4,0
62060 POKE GINTIN+6,1
62062 POKE GINTIN+8,658
62064 POKE GINTIN+10,417
62066 GEMSYS 105
62068 RETURN
62070 '--------------------------
62080 CLEARDESK:
62082 ' uses RECHTECK.BAS
62084 COLOR 1,0,1:
62086 XPOS1=-1:XPOS2=638:YPOS1=-40:YPOS2=-20
62088 GOSUB RECHTECK:COLOR 1,1,1
62090 RETURN
62092 '--------------------------
62900 INIT:
62902 AES#=GB
62904 CONTROL =PEEK(AES#)
62906 GLOBAL  =PEEK(AES#+4)
62908 GINTIN  =PEEK(AES#+8)
62910 GINTOUT =PEEK(AES#+12)
62912 ADDRIN  =PEEK(AES#+16)
62914 ADDROUT =PEEK(AES#+20)
62916 RETURN
62918 '--------------------------
64000 RECHTECK:
64002 ' -->XPOS1; YPOS1; XPOS2; YPOS2
64004 POKE CONTRL,11
64006 POKE CONTRL+2,2
64008 POKE CONTRL+6,0
64010 POKE CONTRL+10,1
64012 POKE PTSIN,XPOS1+1
64014 POKE PTSIN+2,YPOS1+38
64016 POKE PTSIN+4,XPOS2+1
64018 POKE PTSIN+6,YPOS2+38
64020 VDISYS
64022 RETURN
64024 '--------------------------
65000 SCHRIFTART:
65002 ' --> SCHRIFTTYP
65004 '     0=NORMAL      1=FETT      2=HELL
65006 '     4=KURSIV      8=UNTERSTR.16=HOHL
65008 '     oder Kombinationen
65010 '
65012 POKE CONTRL,106
65014 POKE CONTRL+2,0
65016 POKE CONTRL+6,1
65018 POKE INTIN,SCHRIFTTYP
65020 VDISYS
65022 RETURN
65030 SCHRIFTGROESSE:
65032 ' --> GROESSE
65034 '     <9   SEHR KLEIN              9 KLEIN
65036 '  10-15   NORMAL              16-18 GROSS            
65038 '  18-19   SEHR GROSS
65040 '
65042 POKE CONTRL,107
65044 POKE CONTRL+2,0
65046 POKE CONTRL+6,1
65048 POKE INTIN,GROESSE
65050 VDISYS
65052 RETURN
65060 TX:
65062 ' --> TEXT $ ,  XPOS ,  YPOS
65064 ' massstabsgerechte Textausgabe
65066 FOR I=0 TO LEN(TEXT$)-1
65068 POKE INTIN+I*2,ASC(MID$(TEXT$,I+1,1))
65070 NEXT
65072 POKE INTIN+I*2,0
65074 POKE CONTRL,8
65076 POKE CONTRL+2,1
65078 POKE CONTRL+6,LEN(TEXT$)+1
65080 POKE PTSIN,XPOS+1
65082 POKE PTSIN+2,YPOS+38
65084 VDISYS
65086 RETURN
